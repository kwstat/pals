<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bivariate choropleth maps • pals</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bivariate choropleth maps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pals</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bivariate_choropleths.html">Bivariate choropleth maps</a></li>
    <li><a class="dropdown-item" href="../articles/pals_examples.html">Overview of the 'pals' package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kwstat/pals/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bivariate choropleth maps</h1>
                        <h4 data-toc-skip class="author">Kevin
Wright</h4>
            
            <h4 data-toc-skip class="date">2025-03-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kwstat/pals/blob/main/vignettes/bivariate_choropleths.Rmd" class="external-link"><code>vignettes/bivariate_choropleths.Rmd</code></a></small>
      <div class="d-none name"><code>bivariate_choropleths.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="r-setup">R setup<a class="anchor" aria-label="anchor" href="#r-setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://yihui.org/knitr/" class="external-link">"knitr"</a></span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>fig.align<span class="op">=</span><span class="st">"center"</span>, fig.width<span class="op">=</span><span class="fl">6</span>, fig.height<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">90</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="single-variate-choropleth-maps">Single-variate choropleth maps<a class="anchor" aria-label="anchor" href="#single-variate-choropleth-maps"></a>
</h2>
<p>The two maps below show male and female cancer rates on separate
maps. The rates are coarsely binned into three classes so as to be
somewhat comparable to the bivariate choropleth below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://latticeextra.r-forge.r-project.org/" class="external-link">latticeExtra</a></span><span class="op">)</span> <span class="co"># USCancerRates, mapplot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span> <span class="co"># map</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/" class="external-link">classInt</a></span><span class="op">)</span> <span class="co"># classIntervals, findCols</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span> <span class="co"># viewport, pushViewport</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/pals/">pals</a></span><span class="op">)</span> <span class="co"># brewer.blues, stevens.pinkgreen</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/mapplot.html" class="external-link">mapplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">USCancerRates</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rate.male</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rate.female</span><span class="op">)</span>,</span>
<span>          data <span class="op">=</span> <span class="va">USCancerRates</span>,</span>
<span>          colramp <span class="op">=</span> <span class="va">brewer.blues</span>,</span>
<span>          map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">"county"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    projection <span class="op">=</span> <span class="st">"tetra"</span><span class="op">)</span>,</span>
<span>          breaks<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html" class="external-link">classIntervals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">USCancerRates</span><span class="op">$</span><span class="va">rate.female</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">3</span>, style<span class="op">=</span><span class="st">'quantile'</span><span class="op">)</span><span class="op">$</span><span class="va">brks</span>,</span>
<span>          scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bivariate_choropleths_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="comments-on-the-single-variate-choropleth-maps">Comments on the single-variate choropleth maps<a class="anchor" aria-label="anchor" href="#comments-on-the-single-variate-choropleth-maps"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>It is fairly easy to choose a color scheme (e.g. BrewerPal
sequential colors).</p></li>
<li><p>It is fairly easy to interpret a single-variate map.</p></li>
<li><p>If two single-variate maps are drawn with a common scale for the
variates (as shown here), the breakpoints for the colors might be
suitable for one variate and less suited for the other variable. For
example, the rates for females are high in West Virginia and the lower
Mississippi River valley, but the breakpoints on the color scale do not
allow for identification of similar features for males.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="bivariate-color-classes">Bivariate color classes<a class="anchor" aria-label="anchor" href="#bivariate-color-classes"></a>
</h3>
<p>Each variate is divided into thirds (based on percentiles) and a
joint classification for all 9 combinations is defined.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="va">stevens.pinkgreen</span>; <span class="va">nbins</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># categorize rates into 3 percentile bins</span></span>
<span><span class="va">brksm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html" class="external-link">classIntervals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">USCancerRates</span><span class="op">$</span><span class="va">rate.male</span><span class="op">)</span>, n<span class="op">=</span><span class="va">nbins</span>, style<span class="op">=</span><span class="st">'quantile'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in classIntervals(log(USCancerRates$rate.male), n = nbins, style = "quantile"):</span></span>
<span><span class="co">## var has missing values, omitted in finding classes</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brksf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html" class="external-link">classIntervals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">USCancerRates</span><span class="op">$</span><span class="va">rate.female</span><span class="op">)</span>, n<span class="op">=</span><span class="va">nbins</span>, style<span class="op">=</span><span class="st">'quantile'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in classIntervals(log(USCancerRates$rate.female), n = nbins, style = "quantile"):</span></span>
<span><span class="co">## var has missing values, omitted in finding classes</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">classm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/findCols.html" class="external-link">findCols</a></span><span class="op">(</span><span class="va">brksm</span><span class="op">)</span></span>
<span><span class="va">classf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/findCols.html" class="external-link">findCols</a></span><span class="op">(</span><span class="va">brksf</span><span class="op">)</span></span>
<span><span class="co"># convert x,y classes into a joint class x+3(y-1)</span></span>
<span><span class="va">USCancerRates</span><span class="op">$</span><span class="va">class2</span> <span class="op">&lt;-</span> <span class="va">classm</span> <span class="op">+</span> <span class="va">nbins</span><span class="op">*</span><span class="op">(</span><span class="va">classf</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scatterplot of two variates showing bins</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rate.female</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rate.male</span><span class="op">)</span>, data<span class="op">=</span><span class="va">USCancerRates</span>,</span>
<span>     col<span class="op">=</span><span class="fu">cols</span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="va">USCancerRates</span><span class="op">$</span><span class="va">class2</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">19</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bivariate_choropleths_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="bivariate-choropleth-maps">Bivariate choropleth maps<a class="anchor" aria-label="anchor" href="#bivariate-choropleth-maps"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/mapplot.html" class="external-link">mapplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">USCancerRates</span><span class="op">)</span> <span class="op">~</span> <span class="va">class2</span>, data <span class="op">=</span> <span class="va">USCancerRates</span>,</span>
<span>              colramp<span class="op">=</span><span class="va">cols</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0.5</span>, by<span class="op">=</span><span class="fl">1</span>, length<span class="op">=</span><span class="va">nbins</span><span class="op">*</span><span class="va">nbins</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>              xlab<span class="op">=</span><span class="st">""</span>,</span>
<span>              colorkey<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>              map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">"county"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        projection <span class="op">=</span> <span class="st">"tetra"</span><span class="op">)</span>,</span>
<span>              scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">m3</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># add the color legend</span></span>
<span><span class="va">m3leg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">nbins</span><span class="op">*</span><span class="va">nbins</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">nbins</span><span class="op">)</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, col.regions<span class="op">=</span><span class="fu">cols</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   xlab<span class="op">=</span><span class="st">"male  --&gt;"</span>, ylab<span class="op">=</span><span class="st">"female  --&gt;"</span>, cuts<span class="op">=</span><span class="fl">8</span>, colorkey<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   scales<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>draw<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">.15</span>, y<span class="op">=</span><span class="fl">.25</span>, width<span class="op">=</span><span class="fl">.2</span>, height<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="va">vp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m3leg</span>, newpage<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bivariate_choropleths_files/figure-html/unnamed-chunk-3-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m3</span>, more<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in (function (x, y, map, breaks, colramp, exact = FALSE, lwd = 0.5, : 65</span></span>
<span><span class="co">## unmatched regions: alaska,nome, alaska,wade hampton, alaska,haines, alaska,....</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m3leg</span>, position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.15</span>, <span class="fl">.25</span>, <span class="fl">.35</span><span class="op">)</span>, more<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bivariate_choropleths_files/figure-html/unnamed-chunk-3-2.png" width="768" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="comments-on-the-bivariate-choropleth-map">Comments on the bivariate choropleth map<a class="anchor" aria-label="anchor" href="#comments-on-the-bivariate-choropleth-map"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Choosing a good color scheme requires some care. See <span class="citation">Stevens (2015)</span>.</p></li>
<li><p>The single map is larger (than two single-variate choropleth
maps), which makes it easier to see individual counties.</p></li>
<li><p>The larger map also reduces the relative amount of black ink to
draw the county boundaries.</p></li>
<li><p>Because there are few bins for each variate, within-bin structure
for individual variates could be overlooked.</p></li>
</ol>
<p>In the example above, the rates of cancer are high for both men and
women in West Virginia and the lower Mississippi River valley. South and
east of that area, the counties are more green than blue, indicating a
higher rate for men than for women.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-stevens2015bivariate" class="csl-entry">
Stevens, Josh. 2015. <span>“Bivariate Choropleth Maps: A How-to
Guide.”</span> Blog. <em><span>Josh Stevens</span></em>. <a href="https://www.joshuastevens.net/cartography/make-a-bivariate-choropleth-map/" class="external-link uri">https://www.joshuastevens.net/cartography/make-a-bivariate-choropleth-map/</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
